{
  "name": "inbox-assistant",
  "type": "cli",
  "description": "Query Inbox Assistant state (SQLite), manage corpus, search emails, access calendar, and get meeting prep briefings. All commands output JSON by default.",
  "persona": {
    "exclusive": true,
    "context_injection": "aech-cli-inbox-assistant wm snapshot --human",
    "system_addendum": "You are acting as the user's Executive Assistant. You have continuous awareness of their email, calendar, commitments, and relationships through your working memory. Before taking action, consult your working memory to understand the user's current context, pending decisions, and open commitments. Use your CLI tools to query deeper details or take actions on their behalf."
  },
  "command": "aech-cli-inbox-assistant",
  "actions": [
    {
      "name": "list",
      "description": "List ingested emails (JSON by default).",
      "parameters": [
        {"name": "limit", "type": "option", "required": false, "description": "Number of emails to list."},
        {"name": "include-read", "type": "flag", "required": false, "description": "Include read emails."},
        {"name": "human", "type": "flag", "required": false, "description": "Human-readable output instead of JSON."}
      ]
    },
    {
      "name": "search",
      "description": "Search emails and attachments with FTS, vector, or hybrid mode (JSON by default).",
      "parameters": [
        {"name": "query", "type": "argument", "required": true, "description": "Search query."},
        {"name": "limit", "type": "option", "required": false, "description": "Number of results to return."},
        {"name": "mode", "type": "option", "required": false, "description": "Search mode: fts, vector, or hybrid."},
        {"name": "human", "type": "flag", "required": false, "description": "Human-readable output instead of JSON."}
      ]
    },
    {
      "name": "sync-status",
      "description": "Show the sync status for all folders (JSON by default).",
      "parameters": [
        {"name": "human", "type": "flag", "required": false, "description": "Human-readable output instead of JSON."}
      ]
    },
    {
      "name": "stats",
      "description": "Show corpus statistics (emails, attachments, chunks, embeddings) (JSON by default).",
      "parameters": [
        {"name": "human", "type": "flag", "required": false, "description": "Human-readable output instead of JSON."}
      ]
    },
    {
      "name": "attachment-status",
      "description": "Show attachment extraction status (JSON by default).",
      "parameters": [
        {"name": "limit", "type": "option", "required": false, "description": "Number of attachments to list."},
        {"name": "status", "type": "option", "required": false, "description": "Filter by status (pending/success/failed/unsupported)."},
        {"name": "human", "type": "flag", "required": false, "description": "Human-readable output instead of JSON."}
      ]
    },
    {
      "name": "history",
      "description": "View triage history (JSON by default).",
      "parameters": [
        {"name": "limit", "type": "option", "required": false, "description": "Number of entries to list."},
        {"name": "human", "type": "flag", "required": false, "description": "Human-readable output instead of JSON."}
      ]
    },
    {
      "name": "reply-needed",
      "description": "List messages currently marked as requiring a reply (JSON by default).",
      "parameters": [
        {"name": "limit", "type": "option", "required": false, "description": "Number of messages to list."},
        {"name": "human", "type": "flag", "required": false, "description": "Human-readable output instead of JSON."}
      ]
    },
    {
      "name": "dbpath",
      "description": "Print the resolved SQLite DB path.",
      "parameters": []
    },
    {
      "name": "schema",
      "description": "Print CREATE TABLE statements from SQLite.",
      "parameters": []
    },
    {
      "name": "prefs show",
      "description": "Show preferences.json (always JSON).",
      "parameters": []
    },
    {
      "name": "prefs set",
      "description": "Set a key in preferences.json.",
      "parameters": [
        {"name": "key", "type": "argument", "required": true, "description": "Preference key."},
        {"name": "value", "type": "argument", "required": true, "description": "Preference value (string/number/bool/JSON)."}
      ]
    },
    {
      "name": "prefs unset",
      "description": "Unset a key in preferences.json.",
      "parameters": [
        {"name": "key", "type": "argument", "required": true, "description": "Preference key."}
      ]
    },
    {
      "name": "calendar today",
      "description": "Show today's agenda from Microsoft Graph calendar.",
      "parameters": [
        {"name": "tz", "type": "option", "required": false, "description": "Override timezone (IANA format like America/New_York)."},
        {"name": "human", "type": "flag", "required": false, "description": "Human-readable output instead of JSON."}
      ]
    },
    {
      "name": "calendar upcoming",
      "description": "Show upcoming events in the next N hours.",
      "parameters": [
        {"name": "hours", "type": "option", "required": false, "description": "Hours to look ahead (default: 24)."},
        {"name": "limit", "type": "option", "required": false, "description": "Maximum events to show (default: 10)."},
        {"name": "human", "type": "flag", "required": false, "description": "Human-readable output instead of JSON."}
      ]
    },
    {
      "name": "calendar view",
      "description": "View calendar events in a date range.",
      "parameters": [
        {"name": "start", "type": "option", "required": true, "description": "Start date (YYYY-MM-DD or ISO datetime)."},
        {"name": "end", "type": "option", "required": true, "description": "End date (YYYY-MM-DD or ISO datetime)."},
        {"name": "limit", "type": "option", "required": false, "description": "Maximum events to return (default: 100)."},
        {"name": "human", "type": "flag", "required": false, "description": "Human-readable output instead of JSON."}
      ]
    },
    {
      "name": "calendar free-busy",
      "description": "Check free/busy status for one or more users via Graph API getSchedule.",
      "parameters": [
        {"name": "start", "type": "option", "required": true, "description": "Start datetime (YYYY-MM-DD or ISO)."},
        {"name": "end", "type": "option", "required": true, "description": "End datetime (YYYY-MM-DD or ISO)."},
        {"name": "emails", "type": "option", "required": false, "description": "Comma-separated emails to check (default: self)."},
        {"name": "human", "type": "flag", "required": false, "description": "Human-readable output instead of JSON."}
      ]
    },
    {
      "name": "calendar find-times",
      "description": "Find meeting times that work for all attendees via Graph API findMeetingTimes.",
      "parameters": [
        {"name": "attendees", "type": "option", "required": true, "description": "Comma-separated attendee emails."},
        {"name": "duration", "type": "option", "required": false, "description": "Meeting duration in minutes (default: 30)."},
        {"name": "start", "type": "option", "required": false, "description": "Start date constraint (YYYY-MM-DD)."},
        {"name": "end", "type": "option", "required": false, "description": "End date constraint (YYYY-MM-DD)."},
        {"name": "max-results", "type": "option", "required": false, "description": "Maximum suggestions to return (default: 10)."},
        {"name": "human", "type": "flag", "required": false, "description": "Human-readable output instead of JSON."}
      ]
    },
    {
      "name": "calendar create-event",
      "description": "Create a calendar event. Invitations are NOT sent by default - event is created as draft.",
      "parameters": [
        {"name": "subject", "type": "option", "required": true, "description": "Event subject/title."},
        {"name": "start", "type": "option", "required": true, "description": "Start datetime (ISO format)."},
        {"name": "duration", "type": "option", "required": false, "description": "Duration in minutes (default: 30)."},
        {"name": "end", "type": "option", "required": false, "description": "End datetime (overrides duration)."},
        {"name": "attendees", "type": "option", "required": false, "description": "Comma-separated attendee emails."},
        {"name": "location", "type": "option", "required": false, "description": "Event location."},
        {"name": "body", "type": "option", "required": false, "description": "Event body/description."},
        {"name": "online", "type": "flag", "required": false, "description": "Create as Teams meeting."},
        {"name": "human", "type": "flag", "required": false, "description": "Human-readable output instead of JSON."}
      ]
    },
    {
      "name": "calendar working-hours",
      "description": "Get user's working hours from mailbox settings.",
      "parameters": [
        {"name": "human", "type": "flag", "required": false, "description": "Human-readable output instead of JSON."}
      ]
    },
    {
      "name": "calendar prep",
      "description": "Generate meeting preparation briefing with attendee context from email corpus. Use --next for the next meeting or --event-id for a specific event.",
      "parameters": [
        {"name": "event-id", "type": "option", "required": false, "description": "Specific event ID to prepare."},
        {"name": "next", "type": "flag", "required": false, "description": "Prepare for the next meeting that needs prep."},
        {"name": "hours", "type": "option", "required": false, "description": "Lookahead hours when using --next (default: 8)."},
        {"name": "human", "type": "flag", "required": false, "description": "Human-readable output instead of JSON."}
      ]
    },
    {
      "name": "calendar briefing",
      "description": "Generate a daily briefing with schedule overview, alerts (back-to-back meetings, early starts), and meeting prep for important meetings.",
      "parameters": [
        {"name": "date", "type": "option", "required": false, "description": "Date for briefing (YYYY-MM-DD, default: today)."},
        {"name": "tz", "type": "option", "required": false, "description": "Override timezone (IANA format)."},
        {"name": "human", "type": "flag", "required": false, "description": "Human-readable output instead of JSON."}
      ]
    },
    {
      "name": "calendar prep-config",
      "description": "Show current meeting prep configuration and rules (which meetings get prep, timing, exclusions).",
      "parameters": [
        {"name": "human", "type": "flag", "required": false, "description": "Human-readable output instead of JSON."}
      ]
    },
    {
      "name": "wm snapshot",
      "description": "Get complete working memory state: active threads, pending decisions, commitments, and observations. Primary tool for understanding current context.",
      "parameters": [
        {"name": "limit-threads", "type": "option", "required": false, "description": "Max active threads to include (default: 10)."},
        {"name": "limit-decisions", "type": "option", "required": false, "description": "Max pending decisions (default: 5)."},
        {"name": "limit-observations", "type": "option", "required": false, "description": "Max recent observations (default: 10)."},
        {"name": "human", "type": "flag", "required": false, "description": "Human-readable output instead of JSON."}
      ]
    },
    {
      "name": "wm threads",
      "description": "Query active email threads with optional filters.",
      "parameters": [
        {"name": "status", "type": "option", "required": false, "description": "Filter by status (active/stale/resolved)."},
        {"name": "urgency", "type": "option", "required": false, "description": "Filter by urgency (immediate/today/this_week/someday)."},
        {"name": "needs-reply", "type": "flag", "required": false, "description": "Only threads needing reply."},
        {"name": "limit", "type": "option", "required": false, "description": "Max results (default: 20)."},
        {"name": "human", "type": "flag", "required": false, "description": "Human-readable output instead of JSON."}
      ]
    },
    {
      "name": "wm contacts",
      "description": "Query known contacts and relationship context.",
      "parameters": [
        {"name": "relationship", "type": "option", "required": false, "description": "Filter by relationship type."},
        {"name": "vip", "type": "flag", "required": false, "description": "Only VIP contacts."},
        {"name": "external", "type": "flag", "required": false, "description": "Only external contacts."},
        {"name": "search", "type": "option", "required": false, "description": "Search by name or email."},
        {"name": "limit", "type": "option", "required": false, "description": "Max results (default: 20)."},
        {"name": "human", "type": "flag", "required": false, "description": "Human-readable output instead of JSON."}
      ]
    },
    {
      "name": "wm decisions",
      "description": "List pending decisions awaiting user response.",
      "parameters": [
        {"name": "urgency", "type": "option", "required": false, "description": "Filter by urgency."},
        {"name": "limit", "type": "option", "required": false, "description": "Max results (default: 20)."},
        {"name": "human", "type": "flag", "required": false, "description": "Human-readable output instead of JSON."}
      ]
    },
    {
      "name": "wm commitments",
      "description": "List open commitments the user made to others.",
      "parameters": [
        {"name": "overdue", "type": "flag", "required": false, "description": "Only overdue commitments."},
        {"name": "limit", "type": "option", "required": false, "description": "Max results (default: 20)."},
        {"name": "human", "type": "flag", "required": false, "description": "Human-readable output instead of JSON."}
      ]
    },
    {
      "name": "wm observations",
      "description": "View passive learnings from emails (especially CC'd emails).",
      "parameters": [
        {"name": "type", "type": "option", "required": false, "description": "Filter by observation type."},
        {"name": "days", "type": "option", "required": false, "description": "Only observations from last N days."},
        {"name": "limit", "type": "option", "required": false, "description": "Max results (default: 20)."},
        {"name": "human", "type": "flag", "required": false, "description": "Human-readable output instead of JSON."}
      ]
    },
    {
      "name": "wm projects",
      "description": "View inferred projects and initiatives from email patterns.",
      "parameters": [
        {"name": "status", "type": "option", "required": false, "description": "Filter by status (active/on_hold/completed)."},
        {"name": "limit", "type": "option", "required": false, "description": "Max results (default: 20)."},
        {"name": "human", "type": "flag", "required": false, "description": "Human-readable output instead of JSON."}
      ]
    },
    {
      "name": "setup-categories",
      "description": "Setup Outlook categories for email organization. Creates master categories in Outlook with correct colors and initializes preferences.",
      "parameters": [
        {"name": "create-in-outlook", "type": "flag", "required": false, "description": "Create master categories in Outlook via msgraph CLI (default: true)."},
        {"name": "no-create-in-outlook", "type": "flag", "required": false, "description": "Skip creating categories in Outlook."},
        {"name": "reset-defaults", "type": "flag", "required": false, "description": "Reset categories to defaults in preferences.json."},
        {"name": "human", "type": "flag", "required": false, "description": "Human-readable output instead of JSON."}
      ]
    },
    {
      "name": "list-categories",
      "description": "List configured Outlook categories from preferences.",
      "parameters": [
        {"name": "human", "type": "flag", "required": false, "description": "Human-readable output instead of JSON."}
      ]
    },
    {
      "name": "migrate-to-categories",
      "description": "Migrate emails from folder-based organization (aa_* folders) back to Inbox for recategorization. Uses parallel processing for speed.",
      "parameters": [
        {"name": "prefix", "type": "option", "required": false, "description": "Folder prefix to migrate from (default: aa_)."},
        {"name": "dry-run", "type": "flag", "required": false, "description": "Show what would be done without making changes."},
        {"name": "recategorize", "type": "flag", "required": false, "description": "Recategorize emails after moving (default: true)."},
        {"name": "no-recategorize", "type": "flag", "required": false, "description": "Skip recategorization after moving."},
        {"name": "batch-size", "type": "option", "required": false, "description": "Number of emails to fetch per API call (default: 100)."},
        {"name": "concurrency", "type": "option", "required": false, "description": "Number of parallel move operations (default: 10)."},
        {"name": "human", "type": "flag", "required": false, "description": "Human-readable output instead of JSON."}
      ]
    }
  ],
  "documentation": {
    "usage": "aech-cli-inbox-assistant <command> [args]",
    "examples": [
      "aech-cli-inbox-assistant list --include-read",
      "aech-cli-inbox-assistant search 'contract renewal' --mode hybrid",
      "aech-cli-inbox-assistant stats",
      "aech-cli-inbox-assistant reply-needed",
      "aech-cli-inbox-assistant calendar today",
      "aech-cli-inbox-assistant calendar upcoming --hours 48",
      "aech-cli-inbox-assistant calendar view --start 2025-01-20 --end 2025-01-27",
      "aech-cli-inbox-assistant calendar free-busy --start 2025-01-20 --end 2025-01-24",
      "aech-cli-inbox-assistant calendar find-times --attendees 'jane@example.com' --duration 60",
      "aech-cli-inbox-assistant calendar create-event --subject 'Team Sync' --start 2025-01-20T14:00:00 --duration 30 --online",
      "aech-cli-inbox-assistant calendar working-hours",
      "aech-cli-inbox-assistant calendar briefing --human",
      "aech-cli-inbox-assistant calendar prep --next --human",
      "aech-cli-inbox-assistant calendar prep --event-id AAMkAG...",
      "aech-cli-inbox-assistant calendar prep-config --human",
      "aech-cli-inbox-assistant wm snapshot --human",
      "aech-cli-inbox-assistant wm threads --needs-reply",
      "aech-cli-inbox-assistant wm threads --urgency today",
      "aech-cli-inbox-assistant wm contacts --external",
      "aech-cli-inbox-assistant wm contacts --search 'acme'",
      "aech-cli-inbox-assistant wm decisions",
      "aech-cli-inbox-assistant wm commitments --overdue",
      "aech-cli-inbox-assistant wm observations --days 7",
      "aech-cli-inbox-assistant wm projects",
      "aech-cli-inbox-assistant setup-categories --human",
      "aech-cli-inbox-assistant setup-categories --no-create-in-outlook",
      "aech-cli-inbox-assistant list-categories --human",
      "aech-cli-inbox-assistant migrate-to-categories --dry-run --human",
      "aech-cli-inbox-assistant migrate-to-categories --prefix aa_ --human"
    ]
  }
}
